<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Kanban</title>
    <link href="css/kanban.css" rel="stylesheet">
    <script src="js/vue.js"></script>
    <script src="js/vue-router.js"></script>
    <script src="/socket.io/socket.io.js"></script>
  </head>
  <body>
    <script type="text/x-template" id="kanban-template">
        <div class="k-list horizontal">
          <slot/>
        </div>
    </script>

    <script type="text/x-template" id="task-template">
      <div class="task" :data-id="model.id" draggable=true @dblclick="handleDoubleClick">
        <h2>{{model.id}} - {{model.title}}</h2>
      </div>
    </script>


    <script type="text/x-template" id="column-template">
      <div class="k-container">
        <h2 v-if="title" class="column-title">{{title}}</h2>
        <div class="k-list vertical">
          <slot/>
          <container :path="model.path" :contents="model.contents"/>  
        </div>
      </div>
    </script>

    <script type="text/x-template" id="container-template">
      <div @dragstart="handleDragStart" @dragover.prevent class="contents" @drop.prevent="handleDrop" v-el:contents>
        <component v-if="contents" v-for="content in contents" :is="content.type" :model="content"></component>
      </div>  
    </script>

    <script type="text/x-template" id="line-template">
      <div class="k-line">
        <h2 v-if="title" class="line-title">{{title}}</h2>
        <div class="k-list horizontal">
          <slot/>
        </div>
      </div>
    </script>

    <script type="text/x-template" id="backlog-template">
      <kanban>
        <line title="backlog" style="width: 70%">
          <column title="evolution" class="backlog-category" :model="kanban.backlog.evolution"></column>
          <column title="bug" class="backlog-category" :model="kanban.backlog.bug"></column>
          <column title="technical" class="backlog-category" :model="kanban.backlog.technical"></column>
        </line>
        <column title="todo" style="width: 30%" :model="kanban.todo"></column>
      </kanban>  
    </script>

    <script type="text/x-template" id="development-template">
      <kanban>
        <column title="todo" style="width: 15%" :model="kanban.todo"></column>
        <column title="dev" direction="vertical" style="width: 40%">
          <line title="back">
            <column title="ongoing" :model="kanban.development.back.ongoing"></column>  
            <column title="test" :model="kanban.development.back.test"></column>
          </line>
          <line title="front">
            <column title="ongoing" :model="kanban.development.front.ongoing"></column>  
            <column title="test" :model="kanban.development.front.test"></column>
          </line>
          <line title="cms">
            <column title="ongoing" :model="kanban.development.cms.ongoing"></column>  
            <column title="test" :model="kanban.development.cms.test"></column>
          </line>
          <line title="other">
            <column title="ongoing" :model="kanban.development.other.ongoing"></column>  
            <column title="test" :model="kanban.development.other.test"></column>
          </line>
        </column>
        <column title="done" style="width: 40%" :model="kanban.development.done"></column>
      </kanban>
    </script>

    <script type="text/x-template" id="release-template">
      <kanban>
        <column title="done" style="width: 40%" :model="kanban.development.done"></column>
        <column title="qualification" style="width: 20%" :model="kanban.qualification"></column>
        <column title="preproduction" style="width: 20%" :model="kanban.preproduction"></column>
        <column title="production" style="width: 20%" :model="kanban.production"></column>
      </kanban>
    </script>



    <div id="app">
      <p>
        <a v-link="{ path: '/backlog' }">Backlog</a>
        <!--a v-link="{ path: '/development' }">Development</a>
        <a v-link="{ path: '/release' }">Release</a-->
      </p>
      <router-view></router-view>
    </div>  
    <script src="js/kanban.js"></script>
  </body>
  
</html>